# Parallel-Systems-MPI

## Άσκηση 3.1

## Εισαγωγή

Η παρούσα εργασία πραγματεύεται την υλοποίηση ενός παράλληλου αλγορίθμου πολλαπλασιασμού πολυωνύμων χρησιμοποιώντας το πρότυπο επικοινωνίας μηνυμάτων **MPI (Message Passing Interface)**. Στόχος είναι η αποδοτική εκμετάλλευση πολλαπλών διεργασιών για την επιτάχυνση του υπολογισμού, ακολουθώντας τις προδιαγραφές της εκφώνησης και τις αρχές του διανεμημένου υπολογισμού.

## Θεωρητικό Υπόβαθρο

Ο πολλαπλασιασμός δύο πολυωνύμων βαθμού *n* με κλασική συνέλιξη έχει υπολογιστική πολυπλοκότητα **O(n²)**. Παρότι υπάρχουν ταχύτερες μέθοδοι όπως ο **FFT**, η εκφώνηση απαιτεί ρητά τη χρήση της κλασικής προσέγγισης. Η μέθοδος αυτή είναι ιδιαίτερα κατάλληλη για παράλληλη εκτέλεση λόγω της ανεξαρτησίας των επιμέρους υπολογισμών.

## Μοντέλο Παραλληλισμού

Η υλοποίηση ακολουθεί το μοντέλο **SPMD (Single Program Multiple Data)**, όπου όλες οι διεργασίες εκτελούν το ίδιο πρόγραμμα σε διαφορετικά υποσύνολα δεδομένων. Η κατανομή της εργασίας γίνεται με βάση τους συντελεστές του πρώτου πολυωνύμου.

## Σχεδιαστικές Επιλογές

### Κατανομή Δεδομένων

Το πολυώνυμο **A** κατανέμεται στις διεργασίες με *block distribution* χρησιμοποιώντας `MPI_Scatterv`, επιτρέποντας ανισομερή κατανομή όταν το `n+1` δεν διαιρείται ακριβώς με τον αριθμό διεργασιών. Αυτό περιορίζει το **load imbalance** και βελτιώνει τη συνολική απόδοση.

Το πολυώνυμο **B** μεταδίδεται ακέραιο σε όλες τις διεργασίες μέσω `MPI_Bcast`, καθώς κάθε διεργασία χρειάζεται πλήρη πρόσβαση στους συντελεστές του για τον υπολογισμό της συνέλιξης.

### Τοπικός Υπολογισμός

Κάθε διεργασία υπολογίζει ένα τμήμα του τελικού αποτελέσματος χρησιμοποιώντας την κλασική μέθοδο συνέλιξης. Ο υπολογισμός είναι πλήρως ανεξάρτητος μεταξύ διεργασιών, αποφεύγοντας την ανάγκη συγχρονισμού κατά τη φάση υπολογισμού.

### Συλλογή Αποτελεσμάτων

Τα μερικά αποτελέσματα αποθηκεύονται σε τοπικούς πίνακες και συγχωνεύονται στη διεργασία 0 μέσω `MPI_Reduce` με πράξη άθροισης. Η προσέγγιση αυτή ακολουθεί το πρότυπο **compute-locally, reduce-globally**.

## Χρονομέτρηση και Απόδοση

Η εκτέλεση χωρίζεται σε τρία βασικά στάδια: **επικοινωνία**, **υπολογισμό** και **συλλογή αποτελεσμάτων**. Η χρήση του `MPI_Wtime` επιτρέπει ακριβή μέτρηση των επιμέρους χρόνων και του συνολικού χρόνου εκτέλεσης.

## Πειραματική Αξιολόγηση & Scalability

Η απόδοση του προγράμματος αξιολογήθηκε για διάφορους βαθμούς πολυωνύμων (*n = 10⁵, 10⁶*) και διαφορετικό αριθμό διεργασιών MPI.

### Speedup

Ορίζεται ως: Speedup(p) = T₁ / Tₚ
όπου `T₁` ο χρόνος σειριακής εκτέλεσης και `Tₚ` ο χρόνος με *p* διεργασίες.

Παρατηρείται σχεδόν γραμμική επιτάχυνση για μικρό και μεσαίο αριθμό διεργασιών. Για μεγαλύτερο αριθμό διεργασιών, το κόστος επικοινωνίας αρχίζει να επηρεάζει τη συνολική απόδοση.

### Efficiency

Efficiency(p) = Speedup(p) / p

Η αποδοτικότητα μειώνεται όσο αυξάνεται το *p*, κυρίως λόγω του κόστους επικοινωνίας (`Scatterv`, `Bcast`, `Reduce`).

### Ανάλυση Bottleneck

Το βασικό bottleneck εντοπίζεται:
- στο `MPI_Bcast` για μεγάλες τιμές *n*,
- και στο `MPI_Reduce` κατά τη συλλογή του αποτελέσματος.

Παρά ταύτα, το συνολικό όφελος παραλληλισμού παραμένει σημαντικό για μεγάλα προβλήματα.

## Σύγκριση με Άλλες Προσεγγίσεις

Σε σχέση με σειριακή υλοποίηση, ο παράλληλος αλγόριθμος παρουσιάζει μεγάλη επιτάχυνση.  
Σε σύγκριση με υλοποιήσεις κοινόχρηστης μνήμης (**OpenMP / Pthreads**), η MPI εκδοχή εμφανίζει:
- υψηλότερο κόστος επικοινωνίας,
- αλλά καλύτερη κλιμάκωση σε περιβάλλον πολλών κόμβων.

# Άσκηση 3.2 — Παράλληλος Πολλαπλασιασμός Αραιού Πίνακα με Διάνυσμα (SpMV)

## Περιγραφή Προβλήματος

Η δεύτερη άσκηση αφορά την αποδοτική υλοποίηση του πολλαπλασιασμού **αραιού πίνακα με διάνυσμα** (Sparse Matrix–Vector Multiplication, SpMV) με χρήση της αναπαράστασης **Compressed Sparse Row (CSR)** και του προτύπου επικοινωνίας MPI.  
Στόχος είναι η μελέτη της κλιμάκωσης της παράλληλης υλοποίησης και η σύγκριση της επίδοσης της CSR αναπαράστασης έναντι της πυκνής αναπαράστασης.

## Θεωρητικό Υπόβαθρο

Η πράξη SpMV αποτελεί βασικό δομικό λίθο αλγορίθμων γραμμικής άλγεβρας και επιστημονικών υπολογισμών.  
Η χρήση αραιών αναπαραστάσεων μειώνει δραστικά το κόστος μνήμης και υπολογισμού όταν το ποσοστό μηδενικών στοιχείων είναι υψηλό.

Στην αναπαράσταση **CSR**, ο πίνακας αποθηκεύεται σε τρεις πίνακες:
- `values` : μη μηδενικά στοιχεία
- `col_indices` : αντίστοιχες στήλες
- `row_ptr` : δείκτες έναρξης κάθε γραμμής

Η πολυπλοκότητα του SpMV γίνεται **O(nnz)** αντί **O(N²)**.

## Μοντέλο Παραλληλισμού

Η υλοποίηση ακολουθεί SPMD μοντέλο.  
Οι γραμμές του πίνακα κατανέμονται ισομερώς στις διεργασίες, και κάθε διεργασία υπολογίζει τοπικά το τμήμα του διανύσματος αποτελέσματος που της αντιστοιχεί.

## Σχεδιαστικές Επιλογές Υλοποίησης

### Κατασκευή CSR (μόνο στη διεργασία 0)

Η διεργασία 0:
1. Δημιουργεί τυχαίο πυκνό πίνακα με επιθυμητό βαθμό αραιότητας.
2. Μετατρέπει τον πίνακα σε μορφή CSR.
3. Μετρά τον χρόνο κατασκευής της αναπαράστασης.

Η επιλογή κεντρικής κατασκευής απλοποιεί τον έλεγχο ορθότητας και τη μέτρηση κόστους.

### Διανομή Δεδομένων CSR

Η διανομή βασίζεται στον αριθμό γραμμών που αντιστοιχούν σε κάθε διεργασία:
- Οι πίνακες `values` και `col_indices` διαμοιράζονται με `MPI_Scatterv`, λόγω μεταβλητού πλήθους μη μηδενικών.
- Οι δείκτες `row_ptr` ανακατασκευάζονται τοπικά ώστε να διατηρείται σωστή αναφορά στους τοπικούς πίνακες.

Το διάνυσμα `x` αναπαράγεται σε όλες τις διεργασίες μέσω `MPI_Bcast`.

### Παράλληλος Υπολογισμός SpMV

Κάθε διεργασία:
1. Υπολογίζει τοπικά το αντίστοιχο τμήμα του διανύσματος `y`.
2. Χρησιμοποιεί `MPI_Allgather` ώστε το `y` να αποτελέσει το νέο `x` για την επόμενη επανάληψη.

Ο μηχανισμός αυτός επαναλαμβάνεται για τον καθορισμένο αριθμό επαναλήψεων.

### Σύγκριση με Πυκνή Αναπαράσταση

Για τα ίδια δεδομένα εκτελείται παράλληλος πολλαπλασιασμός και με την **πυκνή αναπαράσταση** του πίνακα, ώστε να συγκριθεί άμεσα η επίδοση των δύο προσεγγίσεων.

## Χρονομέτρηση

Το πρόγραμμα μετρά:
1. Χρόνο κατασκευής CSR
2. Χρόνο διανομής δεδομένων
3. Χρόνο υπολογισμού CSR
4. Συνολικό χρόνο CSR
5. Χρόνο υπολογισμού πυκνής αναπαράστασης

Η λεπτομερής αυτή καταγραφή επιτρέπει εντοπισμό bottlenecks και σύγκριση προσεγγίσεων.

## Πειραματική Αξιολόγηση & Συμπεράσματα

Η πειραματική μελέτη δείχνει ότι:

- Η CSR αναπαράσταση υπερτερεί σημαντικά της πυκνής για υψηλές τιμές αραιότητας (≥ 70–80% μηδενικά).
- Το όφελος αυξάνεται όσο μεγαλώνει το μέγεθος του πίνακα.
- Η παράλληλη υλοποίηση κλιμακώνει ικανοποιητικά ως προς τον αριθμό διεργασιών μέχρι το κόστος επικοινωνίας (`Allgather`) να γίνει κυρίαρχο.

Η σύγκριση καταδεικνύει ότι η CSR προσέγγιση είναι κρίσιμη για αποδοτικό SpMV σε μεγάλα και αραιά προβλήματα.



